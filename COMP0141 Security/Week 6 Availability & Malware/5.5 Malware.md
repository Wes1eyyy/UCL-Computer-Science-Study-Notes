## 🛡️ Malware (恶意软件)

- Malware = Malicious Code (恶意代码)  
    → Software written with malicious intent (恶意意图)  
    → Causes harm or unwanted activity (不受欢迎的活动)
    
- Common misunderstanding:  
    → Virus (病毒) ≠ all malware  
    → Virus = just one type of malware (仅是其中一种)
    

---

## 🎯 Motivations (动机)

- Old-school hackers (黑客，90年代前) → For fun, proof, “leetness” (炫技)
    
- Virus golden age (‘80s–‘90s) → Vandalism (破坏)
    
- New criminal age (2000–) → Steal info, control machines, make money (赚钱)
    

---

## 💰 Underground Economy (地下经济)

- Shift: hack-for-fun → hack-for-profit (为了利润)
    
- Technical + economic understanding needed:  
    → Monitor underground channels (监控地下渠道)  
    → Find weak links (找到薄弱环节)
    

---

## 🧬 Taxonomy (分类)

|Self-Spreading (自传播)|Non-Spreading (非传播)|
|---|---|
|Computer Viruses (计算机病毒), Worms (蠕虫)|Trojan Horses (特洛伊木马), Rootkits (内核工具), Keyloggers (键盘记录), Spyware (间谍软件), Dialers (拨号器)|

---

## 🦠 Virus (病毒)

- Infects (感染) other programs, adds evolved copy
    
- Key features:  
    → Reproduce (自我复制)  
    → Attach to host files (附着宿主)  
    → Execute when host runs (随宿主运行)
    

---

## 🔍 Where is it?

- File infection (文件感染):  
    → Overwrite (覆盖型) → Replace program  
    → Parasitic (寄生型) → Add before/after, modify entry  
    → Cavity (空洞型) → Hide in gaps
    
- Macro infection (宏感染):  
    → Uses macro languages (宏语言) e.g., Word, Excel  
    → Auto-executes on load (自动执行)  
    → Often via exploit (漏洞)
    

---

## 📦 Payload (有效载荷)

- Logic bomb (逻辑炸弹): Triggers on condition (条件触发)
    
- Time bomb (时间炸弹): Triggers on time (时间触发)
    
- Trojan (木马): Pretends useful, hides malicious part (伪装有用)
    
- Rootkit: Hides malware, bypasses detection (隐藏自己)
    

---

## 🧩 Polymorphism & Obfuscation (多态与混淆)

- Polymorphic virus (多态病毒): Encrypts/decrypts itself (自加密解密)
    
- Metamorphic virus (变异病毒): Rewrites own code (重写代码)
    
- Obfuscation (混淆): Makes analysis hard (让分析困难)
    

---
# Malware Summary

## Definition
- Malware (恶意软件): short for Malicious Code.
- Software with malicious intent, causing unwanted activity.

## Types of Malware
- Virus (病毒):  
  - Infects other programs.  
  - Needs a host program.  
  - Reproduces, attaches, executes.

- Worm (蠕虫):  
  - Self-replicating, self-contained.  
  - Spreads over networks, often increases speed.

- Trojan Horse (木马):  
  - Disguised as harmless software.  
  - Needs user to install.

- Spyware (间谍软件):  
  - Secretly monitors user, collects private info.  
  - Often as browser plugin.

- Keylogger (键盘记录器):  
  - Records keystrokes.  
  - Captures passwords, social engineering data.

- Rootkit (根套件):  
  - Hides malware, gives continued privileged access.  
  - User-space: trojaned system programs.  
  - Kernel-space: modifies kernel data.

## Malware Spread
- Social engineering (社会工程学): tricks user.  
- Exploit-based (漏洞传播): no human interaction, faster spread.  
- Email, network shares, scanning.

## Defense
- Antivirus (杀毒软件): signature-based, heuristic, behavioral.  
- Sandboxing: run untrusted code in isolation.  
- Host-level: stack protection, ASLR, diversity.  
- Network-level: IDS, connection limits, firewalls.

## Famous Worms
- CodeRed (2001): buffer overflow in IIS, DDoS whitehouse.gov.  
- Slammer (2003): SQL Server vuln, spread in minutes.

## Rootkit Defense
- User-space: Tripwire, Chkrootkit.  
- Kernel-space: KSTAT.  
- Limit: kernel rootkits can fool most tools.

---

